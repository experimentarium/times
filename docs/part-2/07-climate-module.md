# The TIMES Climate Module

## Introduction

This Appendix contains the updated (November 2010) documentation on the Climate Module option for the TIMES model. It provides is a streamlined version of the older version, and contains 5 sections: section 2 contains a detailed description of the theoretical approach taken, section 3 describes the parameters of the climate module, section 4 the variables and section 5 the equations. This version of the documentation does not include the complete formulations for all of the Climate equations (in GAMS form), and neither does it include the full GAMS specifications. However, it should be sufficient to gain a complete understanding of the equations in mathematical form, and should enable the user to define the parameters of the climate module.

## Mathematical formulation

The Climate Module starts from the global emissions of CO<sub>2</sub>, CH<sub>4</sub>, and N<sub>2</sub>O, as generated by the TIMES global model, and proceeds to compute successively:

- the changes in CO<sub>2</sub>, CH<sub>4</sub>, and N<sub>2</sub>O concentrations via three separate sets of equations,
- the total change (over pre-industrial times) in atmospheric radiative forcing resulting from the three gases plus an exogenously specified additional forcing resulting from other causes (other anthropogenic and/or natural causes, as defined by the user), and

- the temperature changes (over pre-industrial times) in two reservoirs (surface and deep ocean).

The Climate Equations used to perform these calculations were initially adapted from Nordhaus and Boyer (1999), who proposed linear recursive equations for calculating concentrations and temperature changes based on the CO<sub>2</sub> life cycle. These linear equations give results that are good approximations of those obtained from more complex climate models (Drouet *et al.*, 2004; Nordhaus and Boyer, 1999). The non-linear radiative forcing equation used by these authors and in TIMES is the same as the one used in most models. The choice of the Nordhaus and Boyer's climate equations is motivated by the simplicity of their approach and by the fact that their climate module is well-documented and acceptably accurate. In our implementation, the forcing equation has been replaced by a linear approximation whose values closely approach the exact ones as long as the useful range is carefully selected. This was done in order to keep the entire model linear, and therefore to allow the user to set constraints on forcing and on temperature as well as on concentrations and on emissions.

Rigorously, the concentration and forcing equations used in the climate module are applicable only to CO<sub>2</sub> emissions, since the concentration equations simulate the carbon cycle. In order to model other GHGs, one way is to use these same equations, while replacing CO<sub>2</sub> emissions by CO<sub>2</sub>-equivalent emissions of any number of gases endogenous to the model. However, a more detailed and generally preferable approach is to model separately the life cycle of each endogenous emission separately, and this is the approach used in TIMES. The additional forcing due to the remaining (non endogenous) emissions, is accounted for via an exogenous forcing quantity directly defined by the user.

We now describe the mathematical equations used at each of the three steps of the climate module.

### Concentrations (accumulation of CO<sub>2</sub>, CH<sub>4</sub>, N<sub>2</sub>O)

a\) CO<sub>2</sub> accumulation is represented as the linear three-reservoir model below[^46]: the atmosphere, the quickly mixing upper ocean + biosphere, and the deep ocean. CO<sub>2</sub> flows in both directions between adjacent reservoirs. The 3-reservoir model is represented by the following 3 equations when the step of the recursion is equal to one year:

$$M_{atm}(y) = E(y) + (1 - \varphi_{atm-up}) M_{atm}(y-1) + \varphi_{up-atm} M_{up}(y-1)$$ (1)

$$M_{up}(y) = (1 - \varphi_{up-atm} - \varphi_{up-lo}) M_{up}(y-1) + \varphi_{atm-up} M_{atm}(y-1) + \varphi_{lo-up} M_{lo}(y-1)$$ (2)

$$M_{lo}(y) = (1 - \varphi_{lo-up}) M_{lo}(y-1) + \varphi_{up-lo} M_{up}(y-1)$$ (3)

with

- $M_{atm}(y)$, $M_{up}(y)$, $M_{lo}(y)$: masses of CO<sub>2</sub> in atmosphere, in a quickly mixing reservoir representing the upper level of the ocean and the biosphere, and in deep oceans (GtC), respectively, in year $y$ (GtC)
- $E(y-1)$: CO<sub>2</sub> emissions in previous year (GtC)
- $\varphi_{ij}$: transport rate from reservoir $i$ to reservoir $j$ ($i, j = atm, up, lo$) from year $y-1$ to $y$

b\) CH<sub>4</sub> accumulation is represented by a so-called single-box model in which the atmospheric methane concentration obeys the following equations assuming a constant annual decay rate of the anthropogenic concentrations $\Phi_{CH4}$ (whereas the natural concentration is assumed in equilibrium):

$$CH4_{atm}(y) = (1 - \Phi_{CH4}) \cdot CH4_{atm}(y - 1) + EA_{CH4}(y)$$ (1a)

$$CH4_{up}(y) = CH4_{up}(y - 1)$$ (1b)

$$CH4_{tot}(y) = CH4_{atm}(y) + CH4_{up}(y)$$ (1c)

where

- $CH4_{atm}$, $CH4_{up}$, and $EA_{CH4}$ are respectively: the atmospheric concentration, the natural concentration[^47] (both expressed in Mt), and the anthropogenic emission of CH<sub>4</sub> (expressed in Mt/yr). $EA_{CH4}$ is generated within the model, but $CH4_{up}$ is fully exogenous (see values for CH4-UP and CH4-ATM in {numref}`cli-parameters`). All quantities are indexed by year.
- $d_{CH4}$ = 2.84 (the density of CH<sub>4</sub>, expressed in *Mt/ppbv*) is then used to convert concentration in Mt into ppbv.
- $1 - \Phi_{CH4}$ is the one-year retention rate of CH<sub>4</sub> in the atmosphere, see {numref}`cli-user-input-parameters`.

c\) N<sub>2</sub>O accumulation is also represented by a single-box model in which the atmospheric N<sub>2</sub>O concentration obeys the following equations:

$$N2O_{atm}(y) = (1 - \Phi_{N2O}) \cdot N2O_{atm}(y - 1) + EA_{N2O}(y)$$ (2a)

$$N2O_{up}(y) = N2O_{up}(y - 1)$$ (2b)

$$N2O_{tot}(y) = N2O_{atm}(y) + N2O_{up}(y)$$ (2c)

where

- $N2O_{atm}$, $N2O_{up}$, and $EA_{N2O}$ are respectively: the atmospheric concentration, the natural concentration (both expressed in Mt), and the anthropogenic emission of N<sub>2</sub>O (expressed in Mt/yr). $EA_{N2O}$ is generated within the model, but $N2O_{up}$ is fully exogenous (see values for N2O-UP and N2O-ATM in {numref}`cli-parameters`). All quantities are indexed by year.
- $d_{N2O}$ = 7.81 (the density of *N<sub>2</sub>O*, expressed in *Mt/ppbv*) is then used to convert concentration in Mt to ppbv units.
- $1 - \Phi_{N2O}$ is the one-year retention rate of N<sub>2</sub>O in the atmosphere, see {numref}`cli-user-input-parameters`.

*Note*: For both CH<sub>4</sub> and N<sub>2</sub>O, the total atmospheric concentrations (UP+ATM) are used in the forcing expressions (see below) and are reported in the results.

### Radiative forcing

We assume, as is routinely done in atmospheric science, that the atmospheric radiative forcing caused by the various gases are additive (IPCC, 2007). Thus:

$$\Delta F(y) = \Delta F_{CO2}(y) + \Delta F_{CH4}(y) + \Delta F_{N2O}(y) + EXOFOR(y)$$ (3)

We now explain these four terms.

a\) The relationship between CO<sub>2</sub> accumulation and increased radiative forcing, $\Delta F_{CO2}(y)$, is derived from empirical measurements and climate models (IPCC 2007).

$$\Delta F_{CO2}(y) = \gamma \times \frac{\ln(M_{atm}(y)/{M_{0}})}{\ln2}$$ (4a)
  
where:

- $M_0$ (i.e. CO2ATM_PRE_IND) is the pre-industrial (circa 1750) reference atmospheric concentration of CO<sub>2</sub> = 596.4 GtC
- $\gamma$ is the radiative forcing sensitivity to atmospheric CO<sub>2</sub> concentration doubling = 3.7 W/m<sup>2</sup>

b) The radiative forcing due to atmospheric CH<sub>4</sub> is given by the following expression (IPCC, 2001)

$$\Delta F_{CH4}(y) = 0.036 \cdot \left( \sqrt{CH4_{y}} - \sqrt{CH4_{0}} \right) - \left\lbrack f(CH4_{y},N2O_{0}) - f(CH4_{0},N2O_{0}) \right\rbrack$$ (4b)

c) The radiative forcing due to atmospheric N<sub>2</sub>O is given by the following expression (IPCC, 2001)

$$\Delta F_{N2O}(y) = 0.12 \cdot \left( \sqrt{N2O_{y}} - \sqrt{N2O_{0}} \right) - \left\lbrack f(CH4_{0},N2O_{y}) - f(CH4_{0},N2O_{0}) \right\rbrack$$ (4c)

where:

$$f(x,y) = 0.47 \cdot \ln\left\lbrack 1 + 2.01 \cdot 10^{- 5} \cdot (xy)^{0.75} + 5.31 \cdot 10^{- 15} \cdot x(xy)^{1.52} \right\rbrack$$ (4d)

Note that the $f(x,y)$ function, which quantifies the cross-effects on forcing of the presence in the atmosphere of both gases (CH<sub>4</sub> and N<sub>2</sub>O), is not quite symmetrical in the two gases. As usual, the 0 subscript indicates the pre-industrial times (1750)

d) $EXOFOR(y)$ is the increase in total radiative forcing at period *t* relative to pre-industrial level due to GHGs that are not represented explicitly in the model. Units = W/m<sup>2</sup>. In Nordhaus and Boyer (1999), only emissions of CO<sub>2</sub> were explicitly modeled, and therefore O(y) accounted for all other GHG's. In TIMES, N<sub>2</sub>O and CH<sub>4</sub> are fully accounted for, but some other substances are not (e.g. CFC's, aerosols, ozone, etc.). Therefore, our values for $EXOFOR(y)$ will differ from those in Nordhaus and Boyer. It is the modeler's responsibility to include in the calculation of $EXOFOR(y)$ only the forcings from those gases and other causes that are not modeled. {numref}`tiam-world-exoforcing-example` shows a possible trajectory for $EXOFOR$.

The parameterization of the three forcing equations (4a, 4b, 4c) is not controversial and relies on the results reported by Working Group I in the IPCC. IPCC (2001, Table 6.2, p.358) provides a value of 3.7 for $\gamma$, smaller than the one used by Nordhaus and Boyer ($\gamma = 4.1$). We have adopted this lower value of 3.7 W/m<sup>2</sup> as default in TIMES. Users are free to experiment with other values of the $\gamma$ parameter. The same reference provides the entire expressions for all three forcing equations.

### Linear approximations

In TIMES, each of the three forcing expressions is replaced by a linear approximation, in order to preserve linearity of the entire model. All three forcing expressions (4a, 4b, 4c) happen to be concave functions. Therefore, two linear approximations are obvious candidates. The first one is an approximation from below, consisting of the chord of the graph between two selected points. The second one has the same slope as the chord and is tangent to the graph, thus approximating the function from above. The final approximation is taken to be the arithmetic average of the two approximations. These linear expressions are easily derived once a range of interest is defined by the user.

As an example, we derive below the linear approximation for the CO<sub>2</sub> forcing expression. The other approximations are obtained in a similar manner, and the parameters of the linear approximations are shown in the next section.

:::{admonition} Linear approximation for the CO<sub>2</sub> forcing expression

First, an interval of interest for the concentration M must be selected by the user. The interval should be wide enough to accommodate the anticipated values of the concentrations, but not so wide as to make the approximation inaccurate. We denote the interval $(M_1,M_2)$.

Next, the linear forcing equation is taken as the half sum of two linear expressions, which respectively underestimate and overestimate the exact forcing value. The underestimate consists of the chord of the logarithmic curve, whereas the overestimate consists of the tangent to the logarithmic curve that is parallel to the chord.

By denoting the pre-industrial concentration level as $M_0$, the general formulas for the two estimates are as follows:

*Overestimate:*

$$F_{1}(M) = \frac{\gamma}{\ln 2} \cdot \left\lbrack \ln(\frac{\gamma}{slope \cdot \ln(2) \cdot M_{0}}) - 1 \right\rbrack + slope \cdot M$$ (5)

*Underestimate*:

$$F_{2}(M) = \gamma \cdot \ln(M_{1}/M_{0})/\ln 2 + slope \cdot (M - M_{1})$$ (6)

*Final approximation*:

$$F_{3}(M) = \frac{F_{1}(M) + F_{2}(M)}{2}$$ (7)

where:

$$slope = \gamma \cdot \frac{\ln(M_{2}/M_{1})/\ln 2}{(M_{2} - M_{1})}$$

:::

The linearized forcing expression implemented in TIMES is the average of the two linear estimates.

### Temperature increase

In the TIMES Climate Module as in many other integrated models, climate change is represented by the global mean surface temperature. The idea behind the two-reservoir model is that a higher radiative forcing warms the atmospheric layer, which then quickly warms the upper ocean. In this model, the atmosphere and upper ocean form a single layer, which slowly warms the second layer consisting of the deep ocean.

$$\Delta T_{up}(y) = \Delta T_{up}(y-1) + \sigma_1\{F(y) - \lambda \Delta T_{up}(y-1) - \sigma_2 [\Delta T_{up}(y-1) - \Delta T_{low}(y-1)]\}$$ (8)

$$\Delta T_{low}(y) = \Delta T_{low}(y-1) + \sigma_3[\Delta T_{up}(y-1) - \Delta T_{low}(y-1)]$$ (9)

with

- $\Delta T_{up}$ = globally averaged surface temperature increase above pre-industrial level,
- $\Delta T_{low}$ = deep-ocean temperature increase above pre-industrial level,
- $\sigma_1$ = 1-year speed of adjustment parameter for atmospheric temperature (also known as the *lag* parameter),
- $\sigma_2$ = coefficient of heat loss from atmosphere to deep oceans,
- $\sigma_3$ = 1-year coefficient of heat gain by deep oceans,
- $\lambda$ = feedback parameter (climatic retroaction). It is customary to write $\lambda$ as $\lambda=\gamma/C_s$, $C_s$ being the *climate sensitivity* parameter, defined as the change in equilibrium atmospheric temperature induced by a doubling of CO<sub>2</sub> concentration.

:::{admonition} Remark

In contrast with most other parameters, the value of $C_s$ is highly uncertain, with a possible range of values from 1°C to 10°C. This parameter is therefore a prime candidate for sensitivity analysis, or for treatment by probabilistic methods such as stochastic programming. In {numref}`cli-parameters`, a best estimate value of 2.9 °C is shown, as per IPCC (2001, 2007).
:::

In the next section we describe all the input parameters required to define the climate equations and those needed to define climate constraints. With few exceptions (such as the densities of the gases), all parameters are modifiable by the user, should the need arise. We also provide {numref}`cli-parameters` summarizing the default values of the parameters.

## Switches and Parameters

### Activating the Climate Module

The Climate Module (CLI) extension of TIMES can be activated and employed by using the Parameters and Switches described in this chapter.

Besides the basic input data parameters described in {numref}`cli-user-input-parameters`, the user also has full control over the CLI component being activated by means of the `$SET CLI YES` switch. This switch is provided by the data handling system when the user indicates that the CLI option is to be included:

```
$SET CLI YES
```

### Calibration

The calibration of the Climate Module to historical values is an important aspect of using the module. The mass balance and temperature equations can be calibrated for the first period by using three alternative calibration years B(1)--1, m(1)--1, and m(1). Whenever D(1)=1, the first two alternatives are equal. The default calibrating year is m(1)--1. The alternative calibration years can be activated by using one of the following two settings in the run-file:

> \$SET CM_CALIB B ! Calibrate at the end of B(1)--1
>
> \$SET CM_CALIB M ! Calibrate at the end of m(1)

### Controlling the years considered beyond EOH

The Climate Equations will be calculated beyond EOH at each of the years for which either a user-defined emission target or a temperature or concentration bound is specified. The years considered thus span between the EOH and the last year for which a CM_MAXC is specified.

In addition, by default any Climate Equations beyond EOH will be calculated only at each year having a year value divisible by 20. This default year resolution can be changed by using the Climate Module constant **\'BEOHMOD\'**. However, note that the years available in the model extend by default to 2200 only, and therefore one may need to adjust the year-span e.g. to 2300 by using the following switch:

```
$SET EOTIME 2300
```

The **reporting years** for the climate variables are the same as the calculation years.

### Input parameters

Like all other aspects of TIMES, the user defines the Climate Module components of the energy system by means of input parameters, which are described in this section. {numref}`cli-user-input-parameters` describes the User Input Parameters that are associated with the Climate Module option.

```{list-table} Definition of Climate Module user input parameters.
:name: cli-user-input-parameters
:header-rows: 1

* - Input Parameter (Indexes)
  - Units & Defaults
  - Description
* - CM_CONST (item)
  - Units: See on the right
  <br>Defaults: See below
  - Various Climate Module constants, where item can be:
  <br>PHI-UP-AT: carbon transfer coefficient UP→ATM
  <br>PHI-AT-UP: carbon transfer coefficient ATM→UP
  <br>PHI-LO-UP: carbon transfer coefficient LO→UP
  <br>PHI-UP-LO: carbon transfer coefficient UP→LO
  <br>GAMMA: radiative forcing sensitivity, in W/m<sup>2</sup>
  <br>CS: temperature sensitivity, in °C
  <br>LAMBDA: $\lambda = \gamma / C_s$
  <br>SIGMA1: speed of adjustment, in W-yr/m<sup>2</sup>/°C
  <br>SIGMA2: thermal capacity ratio, in W/m<sup>2</sup>/°C
  <br>SIGMA3: transfer rate upper to deep ocean, in yr<sup>-1</sup>
  <br>CO2-PREIND: pre-industrial atmosph. CO<sub>2</sub>, in GtC
  <br>PHI-CH4: annual decay of atmospheric CH<sub>4</sub>, fraction
  <br>PHI-N2O: annual decay of atmospheric N<sub>2</sub>O, fraction
  <br>EXT-EOH: activates horizon extension, ≥0, year
  <br>BEOHMOD: defines year interval for reporting, years
* - CM_HISTORY (y,cm_var)
  - Units: See on the right
  <br>Defaults: See below
  - Historical calibration values at years *y*, for *cm_var*:
  <br>CO2-ATM: atmospheric mass of CO<sub>2</sub>, in GtC
  <br>CO2-UP: mass of CO<sub>2</sub> in biosphere, in GtC
  <br>CO2-LO: mass of CO<sub>2</sub> in lower ocean, in GtC
  <br>DELTA-ATM: atmospheric temperature change, in °C
  <br>DELTA-LO: oceanic temperature change, in °C
  <br>CH4-ATM: anthropogenic CH<sub>4</sub> concentration, in Mt
  <br>CH4-UP: natural CH<sub>4</sub> concentration, in Mt
  <br>N2O-ATM: anthropogenic N<sub>2</sub>O concentration, in Mt
  <br>N2O-UP: natural N<sub>2</sub>O concentration, in Mt
* - CM_GHGMAP (r,c,cg)
  - Global units:
  <br>CO<sub>2</sub>: GtC
  <br>CH<sub>4</sub>: Mt
  <br>N<sub>2</sub>O: Mt
  - Conversion factors from regional GHG commodities (c) to global emissions (*cg*) in the Climate Module, where cg=
  <br>CO2-GtC: global CO<sub>2</sub> emissions in GtC
  <br>CH4-Mt: global CH<sub>4</sub> emissions in Mt
  <br>N2O-Mt: global N<sub>2</sub>O emissions in Mt
* - CM_EXOFORC (y)
  - Unit: W/m<sup>2</sup>
  - Radiative forcing from exogenous sources (from greenhouse gases not modelled) in year *y*.
* - CM_LINFOR (y,cm_var,lim)
  - Unit: For
  <br>CO<sub>2</sub>: ppm
  <br>CH<sub>4</sub>/N<sub>2</sub>O: W/m<sup>2</sup>/ppb
  <br>Default: none
  - Parameters for the linear forcing functions for cm_var:
  <br>CO2-PPM: lower (LO) and upper (UP) end of the concentration range over which the forcing function for CO<sub>2</sub> is linearized (in ppm)
  <br>CH4-PPB: multiplier (N) for the CH<sub>4</sub> concentration and constant term (FX) of the linear forcing function
  <br>N2O-PPB: multiplier (N) for the N<sub>2</sub>O concentration and constant term (FX) of the linear forcing function
* - CM_MAXC (y,cm_var)
  - Default: none
  - Maximum level of climate indicator *cm_var* in year *y*.
  <br>CO2-GtC: CO<sub>2</sub> emissions in GtC
  <br>CH4-Mt: CH<sub>4</sub> emissions in Mt
  <br>N2O-Mt: N<sub>2</sub>O emissions in Mt
  <br>CO2-ATM: atm. CO<sub>2</sub> concentration / pre-industrial ratio
  <br>CO2-PPM: atm. CO<sub>2</sub> concentration in ppm
  <br>CH4-PPB: atm. CH<sub>4</sub> concentration in ppb
  <br>N2O-PPB: atm. N<sub>2</sub>O concentration in ppb
  <br>DELTA-ATM: atmospheric temperature change, in °C
  <br>FORCING: total radiative forcing, in W/m<sup>2</sup>
* - CM_MAXCO2C (y)
  - Unit: GtC
  - Maximum level of CO<sub>2</sub> concentration in GtC. 
```


#### Mapping of regional emissions to global emissions

Conversion from regional emissions to global emissions must be done by using the CM_GHGMAP(r,c,cg) parameter, in adequate units. The labels for the global emissions **cg** are \'CO2-GtC\', \'CH4-Mt\' and \'N2O-Mt\'. The parameter IRE_CCVT(r,c,r,cg) can alternatively be also used, if CM_GHGMAP is not available.

Assuming here that the total regional emissions are represented by the commodities TOTCO2, TOTCH4 and TOTN2O, and are measured in kt, as is the case in TIAM models for instance, the mapping and conversion would be the following:

```
CM_GHGMAP(R,'TOTCH4','CH4-MT') = 1E-3;
CM_GHGMAP(R,'TOTN2O','N2O-MT') = 1E-3;
CM_GHGMAP(R,'TOTCO2','CO2-GtC') = 2.727272E-7;
```

#### Deterministic input parameters for CO<sub>2</sub>

- CM_CONST({PHI_AT_UP, PHI_UP_AT, PHI_UP_LO, PHI_LO_UP}) (also denoted $\varphi_{atm-up}$, $\varphi_{up-atm}$, etc, in the equations of section 2): annual CO<sub>2</sub> flow coefficients between the three reservoirs (AT=Atmosphere, UP=Upper ocean layer, LO=Deep ocean layer). These are time-independent coefficients. Units: none
- CM_HISTORY(y,{CO2-ATM, CO2-UP, CO2-LO}): Values at the end of the calibration year *y* of the masses of CO<sub>2</sub> in the atmosphere, the upper ocean layer, and the deep ocean layer, respectively. Note that these values are time- indexed so that the model generator can pick up the correct value according to the calibration year chosen by the user. Units: GtC, Mt(CH<sub>4</sub>), Mt(N<sub>2</sub>O).
- CM_CONST(CO2-PREIND): Pre-industrial atmospheric mass of CO<sub>2</sub>. Units = GtC

### Parameters for the linear CO<sub>2</sub> forcing approximation

CM_LINFOR(datayear,item,lim): lower and upper limit for the concentration of CO<sub>2</sub> in atmosphere, used in the approximation of the radiative forcing equation for CO<sub>2</sub> (see section 2.2 above). *item* may be equal to CO2-ATM (in which case the limit is expressed as a ratio of concentration over pre-industrial concentration), or to CO2-PPM (in which case the limit is expressed in ppm of CO2-equivalent). The index *lim* is either equal to LO or to UP, depending on whether the lower or the upper limit of the range is being specified. For example, the following specifications may be used to select a range from 375 to 550 ppm for the approximation at year 2020:

```
CM_LINFOR('2020','CO2-PPM','LO') = 375;
CM_LINFOR('2020','CO2-PPM','UP') = 550;
```

Note that the values of LINFOR are systematically interpolated. The range can also be specified in a time-dependent manner taking into account the gradual increase in the expected range of possible concentration levels over time. That would further improve the accuracy of the linearization. For example, for 2005 the range could be specified to consist of only a single value, because the actual concentration in 2005 is well-known.

#### Parameters for modeling the concentrations and forcings of other greenhouse gases

> **Historical base year values of natural (UP) and anthropogenic (ATM) concentrations** (in Mt), needed at for the base year of the model (default 2005):

```
CM_HISTORY('2005','CH4-UP') = 1988;
CM_HISTORY('2005','CH4-ATM') = 3067;
CM_HISTORY('2005','N2O-UP') = 2109;
CM_HISTORY('2005','N2O-ATM') = 390;
```

> In the results the total concentrations (UP+ATM) are reported for both CH<sub>4</sub> and N<sub>2</sub>O.
>
> **Annual exponential decay of concentrations (PHI-xxx = 1/Life):**

```
CM_CONST('PHI-CH4') = 0.09158;
CM_CONST('PHI-N2O') = 0.008803;
```

Here $\Phi_{CH4}$, $\Phi_{N2O}$, are the one-year decay rates for methane and N<sub>2</sub>O respectively

> **Parameters for the linear CH<sub>4</sub> and N<sub>2</sub>O forcing approximations:**
>
> Note that for specifying the linear forcing functions for CH<sub>4</sub> and N<sub>2</sub>O, the LO/UP bounds cannot be used, but the slope (\'N\') and constant (\'FX\') of the forcing functions must be directly defined by the user. Example:

```
CM_LINFOR('2010','CH4-PPB','N') = 0.000340;
CM_LINFOR('2010','CH4-PPB','FX') = -0.110;
CM_LINFOR('2010','N2O-PPB','N') = 0.00292;
CM_LINFOR('2010','N2O-PPB','FX') = -0.769;
```

> **Parameter for the exogenous radiative forcing from non-modeled gases** in each year from initial year: CM_EXOFOR(y)
>
> Units: Watts/m<sup>2</sup>.

#### Parameters for the temperature equations

- CM_CONST(SIGMA1) (also denoted $\sigma_1$): speed of adjustment parameter for atmospheric temperature. $1/\sigma_1$ represents the thermal capacity of the atmospheric + upper ocean layer (W-yr/m<sup>2</sup>/°C). Note however that when SIGMA1 is assumed stochastic, its multiple values are specified via the generic S_CM_CONST parameter described below. 
- CM_CONST(SIGMA2) (also denoted $\sigma_2$): ratio of the thermal capacity of the deep oceans to the transfer rate from shallow to deep ocean (W/m<sup>2</sup>/°C). 
- CM_CONST(SIGMA3) (also denoted $\sigma_3$): $1/\sigma_3$ is the transfer rate (per year) from the upper level of the ocean to the deep ocean (yr<sup>-1</sup>). 
- CM_CONST(GAMMA) (also denoted γ): radiative forcing sensitivity to a doubling of the atmospheric CO<sub>2</sub> concentration. Units: Watts/m<sup>2</sup>. 
- CM_CONST(CS): $C_s$, the temperature sensitivity to a doubling of the CO<sub>2</sub> concentration (°C). 
- CM_CONST(LAMBDA) (also denoted $\lambda$): a feedback parameter, representing the equilibrium impact of CO<sub>2</sub> concentrations doubling on climate. $\lambda = \gamma / C_s$. Note however that when $C_s$ is assumed stochastic, its multiple values are specified via the generic S_CM_CONST parameter described below. If all three of $\lambda$, $\gamma$ and $C_s$ are specified, the user-specified $\lambda$ is overridden by the derived value $\gamma / C_s$. 
- CM_HISTORY(y,{DELTA_ATM, DELTA_LOW}): values at the end of the calibration year *y* of the temperature changes (wrt to pre-industrial time) in atmosphere and deep layer, respectively. Units: °C

#### Upper bounds on climate variables

The following parameters are needed if constraints on some climate variables are desired. In TIMES, several climate upper bounds may be specified at any year. These upper bounds are specified via the single generic parameter CM_MAXC(datayear,item), where *datayear* is the year at which the bound applies, and *item* may be any of the following nine choices:

- CO2-ATM: for bounding the ***ratio*** of GHG concentration to the preindustrial concentration (where the pre-industrial concentration is defined by CO2-PREIND); 
- CO2-PPM: for bounding the CO<sub>2</sub> concentration expressed in ppm;
- CH4_PPB: for bounding the CH<sub>4</sub> concentration expressed in ppbv;
- N2O-PPB: for bounding the N<sub>2</sub>O concentration expressed in ppbv;
- FORCING: for bounding the total atmospheric radiative forcing expressed in W/m<sup>2</sup>. (If this bound or the next one on temperature is used, the linearized forcing equation is used rather than the exact forcing equation); 
- DELTA-ATM: for bounding the change in global atmospheric temperature over pre-industrial temperature, expressed in °C; 
- CO2-GTC: for bounding the global CO<sub>2</sub> emissions expressed in GtC;
- CH4-MT: for bounding the global CH<sub>4</sub> emissions expressed in Mt;
- N2O-MT: for bounding the global N<sub>2</sub>O emissions expressed in Mt.

In addition, the user can also bound the CO<sub>2</sub> concentration expressed in GtC, by using CM_MAXCO2C.

#### Incorporating climate variables in UC constraints

When using the Climate Module extension, one can also refer to the climate variables in user constraints. The UC attribute for that purpose is the following:

> UC_CLI(uc_n, side, reg, y, item)

This parameter can be used to define climate variable coefficients in any period-wise user constraints. The UC_GRPTYPE (to be used in UC_ATTR) for this parameter is \'CLI\'. The ***item*** index can be any of the following climate variables:

- CO2-GTC - total global CO<sub>2</sub> emissions (or CO<sub>2</sub>-eq. GHGs)
- CO2-ATM - CO<sub>2</sub> concentration in the atmosphere
- CO2-UP - CO<sub>2</sub> concentration in the biosphere/upper ocean
- CO2-LO - CO<sub>2</sub> concentration in the deep ocean layer
- FORCING - radiative forcing
- DELTA-ATM - atmospheric temperature
- DELTA-LO - deep oceanic temperature

The attribute can be used for defining custom relation­ships by each region, between any of the climate variables and e.g. process flows, activities or capacities, or total commodity flows. However, if used in a global constraint, one should normally define the UC_CLI attribute only for one region (e.g. GLB).

#### Random climate parameters (refer to documentation on stochastic TIMES)

If the stochastic programming version of TIMES is used, several climate parameters may be assumed random. These fall into two categories: the upper bounds on climate quantities discussed in the previous section, and the two climate coefficients, **Cs** and **SIGMA1.**

Regarding the random upper bounds, their multiple values are specified via the stochastic version of the **CM_MAX** parameter, namely **S_CM_MAX(datayear,item,stage,sow)**, where in addition to **datayear** and **item** already explained, **stage** refers to the stage of the event tree and **sow** refers to the state-of-the-world. Note that this single generic parameter will be specified as many times as there are **stages** and **sow**'s in the stochastic event tree. If this parameter is specified, the corresponding values of the deterministic parameter **CM_MAX** are superseded.

Regarding the two random coefficients, their multiple values are then declared via the single generic parameter **S_CM_CONST(item,stage,sow)**, where **item** may be equal to **CS** or to **SIGMA1**, **stage** is the stage number, and **sow** is the state-of-the-world. Note that this single generic parameter will be specified as many times as there are stages and sow's in the stochastic event tree. If this parameter is specified, the corresponding values of the deterministic parameter (**LAMBDA** and/or **SIGMA1**) are superseded.

The reader is referred to Chapter 8 of Part I and the documentation of the stochastic programming version of TIMES for the precise meaning of the **stage** and **sow** concepts.

:::{admonition} Remark

In addition to the possible values of the random parameters, the user must specify the probabilities attached to each ***sow***. This is also explained in the documentation on stochastic TIMES.
:::

#### Parameters for extending the Climate Module equations beyond EOH

The main purpose of extending the climate equations beyond EOH is to be able to set climate targets beyond EOH. This is particularly useful for DeltaT targets, because there is a con­siderable time lag between the decline of emissions and the peak of DeltaT.

The extended climate equations must be explicitly activated by the user. The activation can be done by specifying any non-negative value for the new Climate Module constant **CM_CONST**(**\'EXT-EOH\')**. Different values of the constant will have the following meaning:

```{list-table}
:header-rows: 1

* - Value
  - Meaning
* - -1 (default)
  - The feature is deactivated.
* - 0
  - In this case **\'EXT-EOH\'** will be automatically adjusted to E(*M*), where *M *is the last model year ***m*** for which the end-year **E(*m*)** is specified. The adjusted parameter will then have the same meaning as in the case EXT-EOH \> 0 below.
* - \>0
  - The emissions at EOH will remain constant at the endogenous value in EOH=E(T) (where T=last **milestone year**) until the year MAX(**EXT-EOH**, EOH), and then develop linearly from that value to the first user-defined emission value in a subsequent year.
```

The setting **EXT-EOH**=**0** may be useful for ensuring that any user-defined target values for the emissions will only be taken into account beyond the last ***model year***, even in model runs where a truncated model horizon is used. In such case, when **EXT-EOH**=**0** is used, the emissions are assumed to remain constant between the truncated EOH and the end of the full model horizon.

A positive value **EXT-EOH**=**y** **≤ EOH** means that a linear development of emissions towards the first user-defined value is requested to start im­mediately at the EOH, regardless of the model horizon being truncated or not. Finally, a positive value **EXT-EOH**=**y** **\> EOH** can be useful if the user wishes the emissions to remain constant at the EOH value until a predefined year y \> EOH, before turning into the linear development towards the first user-defined value.

:::{admonition} Warning

If **0 \< EXT-EOH \< E(M) = MAX<sub>m</sub>(E(m))**, any user-defined global emission bounds for CO2-GTC, CH4-MT or N2O-MT, which may be inadvertently specified at years between **MAX(EXT-EOH, EOH)** and **E(M)**, will also be taken into account as target values for the emission trajectories.
:::

The global greenhouse gas emissions that can be considered by the extended climate equations are the three main input emissions to the Climate Module:

- CO2-GTC Global CO<sub>2</sub> emissions, expressed in GtC
- CH4-MT Global CH<sub>4</sub> emissions, expressed in Mt
- N2O-MT Global N<sub>2</sub>O emissions, expressed in Mt

The user can specify target emission values for these emissions at any year(s) beyond EOH. For simplicity, the target emission values are specified by using the **CM_MAXC** parameter, which is normally used for specifying upper bounds for the global emissions, as well as for the temperature and concentrations.

Starting from the year ***B***= MAX(EOH,EXT-EOH), the emissions will be assumed to develop linearly from the value at EOH to the first user-specified value beyond ***B***. If no target values are specified, the emissions will be assumed to remain constant at the EOH value. If several successive values are speci­fied, the emissions will develop linearly also between the successive target values.

Bounds on the global atmospheric temperature, forcing or GHG concentrations can be specified at any years beyond the EOH, in the normal way. In addition, exogenous forcing can be specified and is interpolated beyond EOH.

The Climate Equations will be calculated beyond EOH at each of the years for which either a user-defined emission target or a temperature or concentration bound is specified. The years considered thus span between the EOH and the last year for which a CM_MAXC is specified. However, as described above, any emission bounds between EOH and MAX(EOH,EXT-EOH) will be ignored.

In addition, by default the Climate Equations will be calculated also at each year having a year value divisible by 20. This default year resolution can be changed by using the new Climate Module constant **\'BEOHMOD\'**. Accordingly, if the user wishes the Climate Equations to be calculated at 10 years' intervals (in addition to the CM_MAXC years) she can specify the following parameter:

```
PARAMETER CM_CONST / BEOHMOD 10 /;
```

The **reporting years** for the climate variables are the same as the calculation years.

### Internal parameters

- *CM_PPM<sub>cm_var</sub>*: The densities of the greenhouse gases are hard coded in TIMES (via the internal parameter), with the following values:

> density of CH<sub>4</sub>: 2.84 Mt / ppbv
>
> density of N<sub>2</sub>O: 7.81 Mt / ppbv
>
> density of CO<sub>2</sub>: 2.13 Gt / ppm.

- *CM_PHI<sub>cm_var,t,i,j</sub>*: The transition matrix for climate indicator cm_var between reservoirs i and j and successive years t--1 and t;
- *CM_AA<sub>cm_var,t,i,j</sub>*: The transition matrix for climate indicator cm_var between reservoirs i and j and between the milestone years of periods t--1 and t;
- *CM_BB<sub>cm_var,t,i,j</sub>*: The transition matrix for climate indicator cm_var from emissions in period t to reservoir contents in the same period;
- *CM_CC<sub>cm_var,t,i,j</sub>*: The transition matrix for climate indicator cm_var from emissions in period t--1 to reservoir contents in the period t.

### Reporting parameters

There are two reporting parameters, CM_RESULT and CM_MAXC_M, which contain the results on the levels of the climate variables (or reporting quantities) and the dual values of the constraints defined by using CM_MAXC.

CM_RESULT is indexed by year *y* and result type {e.g. CO2-ATM, CO2-PPM, FORCING, DELTA-ATM, DELTA_LO}. The values represent the quantities at the end of year y. The reporting years y include the milestone years plus any years beyond m(T) that either have some CM_MAXC bound defined or are modulo(BEOHMOD).

- CO2-GtC(y): the total global CO<sub>2</sub> emissions at the end of year **y**.
- CO2-ATM(y): the value of the atmospheric mass of CO<sub>2</sub>-equivalent at the end of year **y**, obtained directly from the variable **VAR_CLIBOX(\'CO2-ATM\',y)**.
- CO2-PPM(y): the value of the atmospheric concentration of CO<sub>2</sub>-equivalent at the end of year **y**.
- FORCING(y): forcing value at end of year y, calculated using the linearized forcing functions as defined by the user.
- FORC+TOT(y): exact forcing value at end of year y, calculated using the logarithmic forcing equation defined in section 2.2 and the CO2-ATM(y) value.
- DELTA_ATM(y): exact atmospheric temperature value at end of year y, calculated using the forcing FORC+TOT(y).
- DELTA_LOW(y): exact lower ocean temperature value at end of year y, calculated using the forcing FORC+TOT(y).

CM_MAXC_M is indexed by year *y* and constraint type. The values are reported for each of the EQ_CLITOT and EQ_CLIMAX equations. The values represent directly the dual values of these constraints at year y.

### Default values of the climate parameters

{numref}`cli-parameters` shows the default values of all parameters of the Climate Module except exogenous forcing. All defaults may be modified by the user.
- CS and SIGMA1 may be assumed random, in which case the default values are not used. The user must specify their values explicitly using the appropriate parameter names described earlier.
- The parameters highlighted blue are upper bounds on five climate variables (in this example, they are set high enough to be inoperative).
- The three parameters highlighted pink concern the extension of emissions beyond EOH, as described in the separate note on this subject.

{numref}`tiam-world-exoforcing-example` shows an example of specification of the EXOFORCING time series.

:::{table} Parameters of the climatic module (default values).
:name: cli-parameters

| Attribute  | Lim | DataYear | Item       | Default value |
| ---------- | :-: | :------: | ---------- | ------------: |
| CM_HISTORY |     |   2005   | CO2-ATM    |        807.27 |
| CM_HISTORY |     |   2005   | CO2-UP     |           793 |
| CM_HISTORY |     |   2005   | CO2-LO     |         19217 |
| CM_HISTORY |     |   2005   | DELTA-ATM  |          0.76 |
| CM_HISTORY |     |   2005   | DELTA-LO   |          0.06 |
| CM_HISTORY |     |   2005   | CH4-UP     |          1988 |
| CM_HISTORY |     |   2005   | CH4-ATM    |          3067 |
| CM_HISTORY |     |   2005   | N2O-UP     |          2109 |
| CM_HISTORY |     |   2005   | N2O-ATM    |           390 |
| CM_CONST   |     |          | GAMMA      |          3.71 |
| CM_CONST   |     |          | PHI-UP-AT  |        0.0453 |
| CM_CONST   |     |          | PHI-AT-UP  |        0.0495 |
| CM_CONST   |     |          | PHI-LO-UP  |       0.00053 |
| CM_CONST   |     |          | PHI-UP-LO  |        0.0146 |
| CM_CONST   |     |          | LAMBDA     |          1.41 |
| CM_CONST   |     |          | CS         |           2.9 |
| CM_CONST   |     |          | SIGMA1     |         0.024 |
| CM_CONST   |     |          | SIGMA2     |          0.44 |
| CM_CONST   |     |          | SIGMA3     |         0.002 |
| CM_CONST   |     |          | CO2-PREIND |         596.4 |
| CM_CONST   |     |          | PHI-CH4    |       0.09158 |
| CM_CONST   |     |          | PHI-N2O    |      0.008803 |
| CM_LINFOR  | LO  |   2005   | CO2-PPM    |           375 |
| CM_LINFOR  | UP  |   2005   | CO2-PPM    |           550 |
| CM_LINFOR  |  N  |   2005   | CH4-PPB    |       0.00034 |
| CM_LINFOR  | FX  |   2005   | CH4-PPB    |      -0.11000 |
| CM_LINFOR  |  N  |   2005   | N2O-PPB    |       0.00292 |
| CM_LINFOR  | FX  |   2005   | N2O-PPB    |      -0.76900 |
| CM_MAXC    |     |   2005   | CO2-PPM    |           500 |
| CM_MAXC    |     |   2005   | CO2-ATM    |          1000 |
| CM_MAXC    |     |   2005   | FORCING    |            10 |
| CM_MAXC    |     |   2005   | DELTA-ATM  |            10 |
| CM_MAXC    |     |   2005   | CO2-GTC    |            50 |
| CM_CONST   |     |          | EXT-EOH    |          2150 |
| CM_CONST   |     |          | BEOHMOD    |            20 |
| CM_MAXC    |     |   2200   | CO2-GTC    |             0 |
:::

:::{table} Example of EXOFORCING (from TIAM-WORLD, 2010 version).
:name: tiam-world-exoforcing-example

|  Attribute |  DataYear |  Value    |
| -----------|-----------|---------  |
| CM_EXOFORC |  2005     |  -0.25376 |
| CM_EXOFORC | 2010      | -0.20475  |
| CM_EXOFORC | 2015      | -0.16055  |
| CM_EXOFORC | 2020      | -0.11689  |
| CM_EXOFORC | 2025      | -0.10104  |
| CM_EXOFORC | 2030      | -0.0774   |
| CM_EXOFORC | 2035      | -0.06398  |
| CM_EXOFORC | 2040      | -0.03787  |
| CM_EXOFORC | 2045      | -0.0354   |
| CM_EXOFORC | 2050      | -0.04528  |
| CM_EXOFORC | 2055      | -0.06434  |
| CM_EXOFORC | 2060      | -0.08634  |
| CM_EXOFORC | 2065      | -0.09485  |
| CM_EXOFORC | 2070      | -0.09632  |
| CM_EXOFORC | 2075      | -0.09254  |
| CM_EXOFORC | 2080      | -0.08929  |
| CM_EXOFORC | 2085      | -0.08868  |
| CM_EXOFORC | 2090      | -0.08273  |
| CM_EXOFORC | 2095      | -0.0796   |
| CM_EXOFORC | 2100      | -0.07447  |
:::

## Variables

The variables that are used in the Climate Module in TIMES are presented in {numref}`cli-specific-variables` below. The climate indicators represented in the Climate Module are grouped according to the following internal sets, which are referred to in the GAMS formulation, presented in Section 5:

- **cm_var**: the set of all climate indicators
- **cm_tkind**: aggregate total indicators (CO2-GtC, CH4-Mt, N2O-Mt, FORCING)
- **cm_emis**: emission indicators (CO2-GtC, CH4-Mt, N2O-Mt)
- **cm_boxmap<sub>tkind,cm_var,cm_box</sub>**: mapping between aggregate indicators tkind, reservoir indicators cm_var, and corresponding box labels (ATM/UP/LO);
- **cm_atmap<sub>tkind,cm_var</sub>**: mapping between aggregate indicators *tkind* and the corresponding boundable atmospheric indicators (CO2-PPM / CH4-PPM / N2O-PPM / DELTA_ATM);
- **cm_atbox<sub>tkind,cm_box</sub>**: mapping between mapping between aggregate emission indicators *tkind* and the corresponding reservoirs that comprise the atmospheric concentration part; contains the pairs {(CO2-GtC,ATM),(CH4-Mt,ATM),(CH4-Mt,UP),(N2O-Mt,ATM),(N2O-Mt,UP)}

```{list-table} Model variables specific to the Climate Module.
:name: cli-specific-variables
:header-rows: 1

* - Variable (Indexes) 
  - Variable Description
* - VAR_CLITOT (cm_var,y)
  - Represents the total amount of climate indicator *cm_var* in year y, where *cm_var* is one of {CO2-GtC, CH4-Mt, N2O-Mt, FORCING}
* - VAR_CLIBOX (cm_var,y)
  - Represents the amount of reservoir indicator *cm_var* in a single reservoir/box in year y, where *cm_var* is one of {CO2-ATM, CO2-UP, CO2-LO, CH4-ATM, CH4-UP, N2O-ATM, N2O-UP, DELTA-ATM, DELTA-LO}.
```

### VAR_CLITOT(cm_var,y)

**Description:** The total amount of aggregate climate indicator in year y.

**Purpose and Occurrence:** This variable tracks the total amount of an aggregate climate indicator by period. This variable is generated for each main emission type of the Climate Module as well as for the total forcing from all greenhouse gas concentrations.

**Units:** GtC (for CO<sub>2</sub> emissions), Mt (for CH<sub>4</sub> and N<sub>2</sub>O emissions), or W/m<sup>2</sup> (for total radiative forcing).

**Bounds:** This variable can be directly bounded with the CM_MAXC attribute.

### VAR_CLIBOX(cm_var,y)

**Description:** The amount of climate indicator in a reservoir.

**Purpose and Occurrence:** This variable tracks the amount of reservoir-specific climate indicator by period. This variable is generated for each of the reservoirs for each of the aggregate indicators: ATM/UP/LO for CO<sub>2</sub> emissions, ATM/UP for CH<sub>4</sub> and N<sub>2</sub>O emissions, and ATM/LO for FORCING (connected to the temperature reservoirs).

**Units:** GtC (for CO<sub>2</sub> emissions), Mt (for CH<sub>4</sub> and N<sub>2</sub>O emissions), or °C (for temperature reservoirs).

**Bounds:** Only the total atmospheric amounts can be bounded with the CM_MAXC attribute (CO2-ATM, CO2-PPM, CH4-PPB, N2O-PPB, DELTA-ATM).

## Equations

There are three blocks of definitional equations: the first block of equations calculates the global emissions of GHG (either all in CO<sub>2</sub> eq., or separately for CO<sub>2</sub>, CH<sub>4</sub> and N<sub>2</sub>O) as well as the total (linearized) radiative forcing, the next block calculates the concentrations of the greenhouse gases in the reservoirs, and the third block calculates the atmospheric temperature and lower ocean temperature at period t.

In addition, there is a generic block of equations expressing the upper bounding of the five climate quantities discussed in subsection 3.4.6. This generic equation is generated as many times as an upper bound on any climate variable is specified by the user, and is not generated if no upper bound is specified.

We now give the formulations of these constraints.

:::{admonition} Reminder

The Climate Module formulation is activated at run time from the data handling system, which in turn set the `$SET CLI YES` switch.
:::

General notation:

- *D(t):* duration of period *t, t=1 to T*
- *B(t):* first year in period *t, t=1 to T*
- *m(t):* milestone year of period t (approximate middle year of period, defined as $m(t) = B(t) + \left\lfloor (D(t) - 1)/2 \right\rfloor$
- *y:* designates a year, while *t* designates a period (ranging from 1 to T)
- *Υ:* designates the calibration year, which can be chosen by the user to be either *B*(1)--1, *m*(1)--1, or *m*(1)*,* see section 3.2 above.

```{list-table} Climate Module specific constraints (all in the GAMS file equ_ext.cli).
:name: cli-specific-constraints
:header-rows: 1

* - Constraints (Indexes)
  - Constraint Description
* - EQ_CLITOT (cm_var,t)
  - Defines the amount of global greenhouse gas emissions in each period; defines the amount of total radiative forcing from the greenhouse gas concentrations in each period *t*.
* - EQ_CLICONC (cm_var,cm_box,t)
  - Defines the mass of each greenhouse gas *cm_var* in each reservoir *cm_box* at the end of the milestoneyr **m(t)** of period *t*.
* - EQ_CLITEMP (cm_box,t)
  - Defines the temperature increase in the each reservoir *cm_box* (the lower atmosphere and the lower ocean layer) over its pre-industrial temperature measured at the end of milestoneyr **m(t)** of period *t*.
* - EQ_CLIMAX (y,cm_var)
  - Imposes an upper bound on any or all of the climate variables *cm_var* (*CO2-GTC, CH4-MT, N2O-MT, CO2-ATM, CO2-PPM, CH4-PPB, N2O-PPB, FORCING, DELTA-ATM)*, at any desired year *y*, according to the user-defined input parameter CM_MAXC.
```

### EQ_CLITOT(cm_var,t)

**Description:** Defines the total amount of aggregate climate indicator in period t.

**Purpose:** This constraint defines the amount of global greenhouse gas emissions in each period and the amount of total radiative forcing from the greenhouse gas concentrations in each period *t*.

This equation is generated in each time period for all indicators considered.

**Units:** Global emission units (GtC, Mt) or forcing units (W/m<sup>2</sup>)

**Type:** *Binding.* The equation is an equality (=) constraint.

**Interpretation of the results:**

*Primal:* The level of this constraint must be zero in a feasible solution.

*Dual variable:* The dual variables represent the marginal prices of the global emissions / forcing (when undiscounted).

**Remarks**:
- For CO2, the linear forcing function parameters *CM_LINFOR<sub>t,cm_emis,'FX'</sub>* and *CM_LINFOR<sub>t,cm_emis,'N'</sub>* are automatically calculated by the model generator from any user-defined *CM_LINFOR<sub>t,cm_emis,'LO'</sub>* and *CM_LINFOR<sub>t,cm_emis,'UP'</sub>*.

**Equation:**

$$EQ\_ CLITOT_{cm\_ tkind,t}\forall\left\lbrack \left( t \in \mathbf{milestonyr} \right) \right\rbrack$$

$${\sum_{\begin{aligned}
 & cm\_ tkind \in \mathbf{cm}\_\mathbf{emis} \\
 & (r,c,s) \in \mathbf{rtcs}\_\mathbf{var}\mathbf{c}_{\mathbf{r},\mathbf{c},\mathbf{t},\mathbf{s}}
\end{aligned}}^{}{VAR\_ COMNET_{r,t,c,s} \times CM\_ GHGMAP_{r,c,cm\_ tkind}}
} \\ {\sum_{\mathbf{cm}\_\mathbf{emi}\mathbf{s}_{\mathbf{cm}\_\mathbf{tkind}}}^{}\left( \begin{aligned}
 & CM\_ LINFOR_{t,cm\_ emis,'N'} \times \\
 & \left( \sum_{\begin{aligned}
 & \mathbf{cm}\_\mathbf{atbo}\mathbf{x}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{box}} \\
 & \mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}}
\end{aligned}}^{}{VAR\_ CLIBOX_{cm\_ var}} \right) \\
 & CM\_ LINFOR_{t,cm\_ emis,'FX'}
\end{aligned} \right) + 
} \\ {+ CM\_ EXOFORC_{t}
} \\ {\left\{ = \right\}
} \\ {VAR\_ CLITOT_{cm\_ tkind,t}}$$

### EQ_CLICONC(cm_var,cm_box,t)

**Description:** Defines the reservoir-specific amounts of concentration indicator in each period.

**Purpose:** Defines the dynamic relationship between emissions and the concentration in the reservoirs modelled for each greenhouse gas, such that the amount of concentration in reservoir *i* and period *t* may depend on the amounts of concentrations in any reservoir *k* in period *t--1*, and on the emissions in period *t*.

**Units:** Global emission units (GtC, Mt).

**Type:** *Binding.* The equation is an equality (=) constraint.

**Interpretation of the results:**

*Primal:* The level of this constraint must be zero in a feasible solution.

*Dual variable:* The dual variable of this constraint in the solution is of little interest.

**Remarks:**
- See expressions for the transfer matrices on next page.
- The equations beyond the last milestone year m(T) are similar, but omitted here.

**Equation:**

$$EQ\_ CLICONC_{cm\_ emis,cm\_ box,t}\forall\left\lbrack \left( t \in \mathbf{milestonyr} \right) \right\rbrack$$

$${\sum_{\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}2}}^{}{VAR\_ CLIBOX_{cm\_ var,t - 1} \times CM\_ AA_{cm\_ emis,t,cm\_ box,cm\_ box2}} + 
}{CM\_ BB_{cm\_ emis,t,cm\_ box} \times VAR\_ CLITOT_{cm\_ emis,t} + 
}{CM\_ CC_{cm\_ emis,t,cm\_ box} \times VAR\_ CLITOT_{cm\_ emis,t - 1} + 
}{\sum_{\begin{matrix}
\mathbf{miyr}\_\mathbf{1}_{t} \\
\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}\mathbf{2}}
\end{matrix}}^{}{CM\_ CONST_{cm\_ var} \times CM\_ AA_{cm\_ emis,t,cm\_ box,cm\_ box2}}
}{\left\{ = \right\}
}{\sum_{\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}}}^{}{VAR\_ CLIBOX_{cm\_ var,t}}}$$

$$
{CM\_ AA_{cm\_ emis,t,i,j} = \left\{ A_{ij}(t) \right\} = \ PHI^{n(t)}(PHI^{0} = I),\mspace{6mu}\text{where}\mspace{6mu}
}{PHI\text{  is the 3} \times \text{3 matrix}:\begin{bmatrix}
(1 - PHI\_ AT\_ UP) & PHI\_ UP\_ AT & 0 \\
PHI\_ AT\_ UP & (1 - PHI\_ U\_ AT - PHI\_ UP\_ LO) & PHI\_ LO\_ UP \\
0 & PHI\_ UP\_ LO & (1 - PHI\_ LO\_ UP)
\end{bmatrix}
}
{CM\_ BB_{cm\_ emis,t,i} = \left\{ BB_{i1}(t) \right\}\text{  is the first column of the matrix: }
}{BB(t) = \ \sum_{i = 0}^{p(t) - 1}{PHI^{i}}\mspace{18mu}if\mspace{18mu}p(t) \geq 1
}{BB(t) = 0\mspace{18mu}if\mspace{18mu}p(t) = 0
}{CM\_ CC_{cm\_ emis,t,i} = \left\{ CC_{i1}(t) \right\}\text{  is the first column of the matrix :}
}{CC(t) = \ \sum_{i = p(t)}^{n(t) - 1}{PHI^{i}}\mspace{18mu}if\mspace{18mu}n(t) \geq p(t) + 1
}{CC(t) = 0\mspace{18mu}if\mspace{18mu}n(t) = p(t)
}{p(t)\text{  } = \text{  }\left\lfloor \frac{D(t) + 1}{2} \right\rfloor,n(t)\text{  } = \ m(t) - m(t - 1)\mspace{18mu} if\ t \neq 1,\text{   }
}{p(t)\text{  } = \ m(t) - \Upsilon,n(t)\text{  } = \ p(t)\mspace{18mu}if\mspace{18mu}t = 1
}{D(t)\text{  is the number of years in period }t,and m(t)\text{is the middle year of period}\ t\text{ defined as}\mspace{18mu}
}{m(t) = B(t) + \left\lfloor \frac{D(t) - 1}{2} \right\rfloor
}{\left\lfloor x \right\rfloor\ \text{ denotes the largest integer smaller than or equal to}\ x}$$

### EQ_CLITEMP(cm_var,cm_box,t)

**Description:** Defines the reservoir-specific amounts of temperature indicator in each period.

**Purpose:** Defines the dynamic relationship between forcing and the temperature increase in the reservoirs modelled, such that the amount of temperatures increase in reservoir *i* and period *t* may depend on the amounts of temperature increase in any reservoir *k* in period *t--1*, and on the radiative forcing in period *t*.

**Units:** Global temperature units (°C).

**Type:** *Binding.* The equation is an equality (=) constraint.

**Interpretation of the results:**

*Primal:* The level of this constraint must be zero in a feasible solution.

*Dual variable:* The dual variable of this constraint in the solution is of little interest.

**Remarks:**
- See expressions for the transfer matrices on next page.
- The equations for years beyond m(T) are similar, but omitted here.

**Equation:**

$$EQ\_ CLITEMP_{cm\_ box,t}\forall\left\lbrack \left( t \in \mathbf{milestonyr} \right) \right\rbrack$$

$${\sum_{\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{'\mathbf{FORCING}',\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}2}}^{}{VAR\_ CLIBOX_{cm\_ var,t - 1} \times CM\_ AA_{'FORCING',t,cm\_ box,cm\_ box2}} + 
}\\ \\{CM\_ BB_{'FORCING',t,cm\_ box} \times VAR\_ CLITOT_{'FORCING',t} + 
}\\ \\{CM\_ CC_{'FORCING',t,cm\_ box} \times VAR\_ CLITOT_{'FORCING',t - 1} + 
}\\ \\{\sum_{\begin{matrix}
\mathbf{miyr}\_\mathbf{1}_{t}
\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{'\mathbf{FORCING}',\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}\mathbf{2}}
\end{matrix}}^{}{CM\_ CONST_{cm\_ var} \times {CM\_ AA_{'FORCING,t,cm\_ box,cm\_ box2}}}
}{\left\{ = \right\}
}\\ \\{\sum_{\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{\mathbf{FORCING}',\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}}}^{}{VAR\_ CLIBOX_{cm\_ var,t}}}$$

$$
{CM\_ AA_{'FORCING',t,i,j} = \left\{ A_{ij}(t) \right\} = \ PHI^{n(t)}(PHI^{0} = I),\mspace{6mu}\text{where}\mspace{6mu}
}\\ \\{PHI\text{  is the 3} \times \text{3 matrix}:\begin{bmatrix}
(1 - SIGMA1 \times (LAMBDA + SIGMA2) & SIGMA1 \times SIGMA2 & 0 \\
SIGMA3 & (1 - SIGMA3) & 0 \\
0 & 0 & 0
\end{bmatrix}
}\\ \\
{CM\_ BB_{'FORCING',t,i} = \left\{ BB_{i1}(t) \right\}\text{  is the first column of the matrix: }
}\\ \\{BB(t) = SIGMA1 \times \ \sum_{i = 0}^{n(t) - 1}{\frac{n(t) - i}{n(t)} \times PHI^{i}}\mspace{18mu}
}\\ \\{CM\_ CC_{'FORCING',t,i} = \left\{ CC_{i1}(t) \right\}\text{  is the first column of the matrix :}
}\\ \\{CC(t) = \ SIGMA1 \times \sum_{i = 0}^{n(t) - 1}{\frac{i}{n(t)} \times PHI^{i}}
}\\ \\{n(t)\text{  } = \ m(t) - m(t - 1)\mspace{6mu}\mspace{6mu} if\ t \neq 1,\text{   }
}\\ \\{n(t)\text{  } = \ m(t) - Yift = 1
}\\ \\{D(t)\text{  is the number of years in period }t,\text{ and}m(t)\text{is the middle year of period}\ t\text{ defined as}
}\\ \\{m(t) = B(t) + \left\lfloor \frac{D(t) - 1}{2} \right\rfloor
}\\ \\{\left\lfloor x \right\rfloor\ \text{ denotes the largest integer smaller than or equal to}\ x}$$

### EQ_CLIMAX(y,cm_var)

**Description:** Constraint that sets an upper bound on the climate indicator in a give year.

**Purpose:** To set an upper bound for a climate indicator variable in any desired year y. The variables that can be bounded are the total global emissions and the total radiative forcing (VAR_CLITOT), the atmospheric concentrations of greenhouse gases (sum of VAR_CLIBOX variables), and the increase in atmospheric temperature (VAR_CLIBOX). The bounds can be specified by using the *CM_MAXC<sub>y,cm_var</sub>* attribute.

**Units:** Units of the variable(s) bounded.

**Type:** *Binding.* The equation is a less than or equal to inequality (≤) constraint.

**Interpretation of the results:**

*Primal:* The level of this constraint must be less than or equal to zero in a feasible solution.

*Dual variable:* The dual variable of this constraint in the solution may be used to derive the marginal price of the climate indicator constrained (when undiscounted; global dual values are, ex officio, reported without undiscounting, as no well-defined "global discount factors" exist, only regional ones).

**Remarks:**
- The *CM_MAXC* bounds defined on CO2-ATM are automatically converted into equivalent bounds on CO2-PPM.
- The coefficients $\alpha_y$ and $\beta_y$ in the equations are such that $y = \alpha_y(m(t)-y) + \beta_y(y-m(t-1))$, for all $y$ in the range $m(t-1) < y ≤ m(t)$.

**Equation:**

$$EQ\_ CLIMA{X_{y,cm\_ var}}^{}\forall\left\lbrack \left\{ (y,cm\_{var})|CM\_ MAXC_{y,cm\_ var} \right\} \right\rbrack$$

**Case A. For total emissions, up to m(T)**

$${\alpha_{y} \times VAR\_ CLITOT_{cm\_ emis,t - 1} + \beta_{y} \times VAR\_ CLITOT_{cm\_ emis,t}
}{\leq CM\_ MAXC_{y,cm\_ emis}}$$

**Case B. For atmospheric GHG concentrations, up to m(T)**

$${\sum_{\begin{matrix}
\mathbf{cm}\_\mathbf{atbo}\mathbf{x}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{box}} \\
\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}}
\end{matrix}}^{}{\alpha_{y} \times VAR\_ CLIBOX_{cm\_ var,t - 1} + \beta_{y} \times VAR\_ CLIBOX_{cm\_ var,t}}
}{\leq CM\_ MAXC_{y,cm\_ var}}$$

**Case C. For total radiative forcing, up to m(T)**

$${\alpha_{y} \times VAR\_ CLITOT_{'FORCING',t - 1} + \beta_{y} \times VAR\_ CLITOT_{'FORCING',t}
}{\leq CM\_ MAXC_{y,'FORCING'}}$$

**Case D. For increase in global atmospheric temperature, up to m(T):**

$${\sum_{\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{'\mathbf{FORCING}',\mathbf{cm}\_\mathbf{var},'\mathbf{ATM}'}}^{}{\alpha_{y} \times VAR\_ CLIBOX_{cm\_ var,t - 1} + \beta_{y} \times VAR\_ CLIBOX_{cm\_ var,t}}
}{\leq CM\_ MAXC_{y,cm\_ var}}$$

**Case E. For atmospheric GHG concentrations, beyond m(T):**

$$\sum_{\begin{matrix}
\mathbf{cm}\_\mathbf{atbo}\mathbf{x}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{box}} \\
\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{\mathbf{cm}\_\mathbf{emis},\mathbf{cm}\_\mathbf{var},\mathbf{cm}\_\mathbf{box}}
\end{matrix}}^{}{VAR\_ CLIBOX_{cm\_ var,y}}\quad \leq \quad CM\_ MAXC_{y,cm\_ var}$$

**Case F. For total radiative forcing, beyond m(T):**

$$VAR\_ CLITOT_{'FORCING',y}\quad \leq \quad CM\_ MAXC_{y,'FORCING'}$$

**Case G. For increase in global atmospheric temperature, beyond m(T):**

$$\sum_{\mathbf{cm}\_\mathbf{boxma}\mathbf{p}_{'\mathbf{FORCING}',\mathbf{cm}\_\mathbf{var},'\mathbf{ATM}'}}^{}{VAR\_ CLIBOX_{cm\_ var,y}}\quad \leq \quad CM\_ MAXC_{y,cm\_ var}$$

## References

Drouet L., Edwards N.R. and A. Haurie (2004). "Coupling Climate and Economic Models in a Cost-Benefit Framework: A Convex Optimization Approach". Submitted to *Environmental Modeling and Assessment.*

IPCC. 1996. *Climatic change 1995: The Science of Climate Change.* Intergovernmental Panel on Climate Change, Second Assessment Report, Working Group I. Cambridge: Cambridge University Press. p.572.

IPCC. 2001. *Climatic change 2001: The Scientific Basis.* Intergovernmental Panel on Climate Change, Third Assessment Report, Working Group I. Cambridge: Cambridge University Press. p.944.

Nordhaus, W. D. and J. Boyer. 1999. *Roll the DICE Again: Economic Models of Global Warming*. Yale University, manuscript edition.

Wigley, T.M.L., Solomon, M. and S.C.B. Raper. 1994. *Model for the Assessment of Greenhouse-Gas Induced Climate Change*. Version 1.2. Climate Research Unit, University of East Anglia, UK.


[^46]: There exists another well-known representation of CO<sub>2</sub> accumulation equations, using a five-box model.

[^47]: Note that the subscripts *atm* and *up*, which for the CO<sub>2</sub> equations referred to the atmosphere and upper reservoirs, have been reused for the CH<sub>4</sub> and N<sub>2</sub>O equations to stand for anthropogenic and natural concentrations.

